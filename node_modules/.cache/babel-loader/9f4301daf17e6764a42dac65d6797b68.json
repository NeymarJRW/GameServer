{"remainingRequest":"/Users/gaga/Desktop/GameServer/node_modules/thread-loader/dist/cjs.js!/Users/gaga/Desktop/GameServer/node_modules/babel-loader/lib/index.js!/Users/gaga/Desktop/GameServer/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/gaga/Desktop/GameServer/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gaga/Desktop/GameServer/src/views/Manage/Marilyn.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/gaga/Desktop/GameServer/src/views/Manage/Marilyn.vue","mtime":1555737285000},{"path":"/Users/gaga/Desktop/GameServer/node_modules/cache-loader/dist/cjs.js","mtime":1558076220000},{"path":"/Users/gaga/Desktop/GameServer/node_modules/thread-loader/dist/cjs.js","mtime":1557114192000},{"path":"/Users/gaga/Desktop/GameServer/node_modules/babel-loader/lib/index.js","mtime":1557114185000},{"path":"/Users/gaga/Desktop/GameServer/node_modules/cache-loader/dist/cjs.js","mtime":1558076220000},{"path":"/Users/gaga/Desktop/GameServer/node_modules/vue-loader/lib/index.js","mtime":1557114192000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { classIndex, classAdd, classDelete, classUpdate, gameImgurl, judgeName, onfocus, onblur } from \"@/api/index\";\nimport { setTimeout } from \"timers\";\nexport default {\n  data: function data() {\n    return {\n      btnAdd: true,\n      btnEdit: true,\n      datalist: [],\n      marilynName: \"\",\n      marilynEnName: \"\",\n      marilynOrder: \"\",\n      addCard: false,\n      deleteModel: false,\n      modal_loading: false,\n      currentDelete: \"\",\n      editState: false,\n      // 关闭状态\n      editModel: false,\n      updateName: \"\",\n      updateEnName: \"\",\n      updateOrder: \"\",\n      updateId: \"\",\n      spinShow: true,\n      gameUpload: \"\",\n      marilynimg: \"\",\n      updateImage: \"\",\n      gameImgurl: \"\"\n    };\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    var judgename_add = document.querySelector(\".judgename_add\").querySelector(\"input\");\n    var judgename_edit = document.querySelector(\".judgename_edit\").querySelector(\"input\");\n    onfocus(judgename_add, function () {\n      judgename_add.style.border = \"1px solid #2d8cf0\";\n      _this.btnAdd = true;\n    });\n    onblur(judgename_add, function () {\n      judgeName({\n        name: _this.marilynName,\n        type: \"class\"\n      }).then(function (res) {\n        if (res.state == 0) {\n          if (_this.addCard) {\n            _this.btnAdd = false;\n\n            _this.$Message.error(\"名字为空或该名字已存在\");\n\n            judgename_add.style.border = \"1px solid red\";\n            setTimeout(function () {\n              judgename_add.style.border = \"1px solid #dcdee2\";\n            }, 2000);\n          }\n        }\n      });\n    });\n    onfocus(judgename_edit, function () {\n      judgename_edit.style.border = \"1px solid #2d8cf0\";\n      _this.btnEdit = true;\n    });\n    onblur(judgename_edit, function () {\n      judgeName({\n        name: _this.updateName,\n        type: \"class\",\n        id: _this.updateId\n      }).then(function (res) {\n        if (res.state == 0) {\n          if (_this.editModel) {\n            _this.btnEdit = false;\n\n            _this.$Message.error(\"名字为空或该名字已存在\");\n\n            judgename_edit.style.border = \"1px solid red\";\n            setTimeout(function () {\n              judgename_edit.style.border = \"1px solid #dcdee2\";\n            }, 2000);\n          }\n        }\n      });\n    });\n    this.gameImgurl = gameImgurl;\n    this.getData();\n  },\n  watch: {\n    $route: function $route(to, from) {},\n    addCard: function addCard(value) {\n      this.btnAdd = true;\n    },\n    editModel: function editModel(value) {\n      this.btnEdit = true;\n    }\n  },\n  methods: {\n    getData: function getData() {\n      var _this2 = this;\n\n      this.spinShow = true;\n      classIndex().then(function (res) {\n        if (res.state === \"1\") {\n          _this2.datalist = res.msg;\n          _this2.spinShow = false;\n        }\n      });\n    },\n    uploadSuccess: function uploadSuccess(res, file) {},\n    addClass: function addClass() {\n      var _this3 = this;\n\n      if (this.marilynName.trim().length !== 0) {\n        var data = new FormData();\n        data.append(\"file\", this.file);\n        data.append(\"name\", this.marilynName);\n        data.append(\"alias\", this.marilynEnName);\n        data.append(\"order\", this.marilynOrder || this.datalist.length + 1);\n        var option = {\n          method: \"post\",\n          body: data\n        };\n        fetch(classAdd, option).then(function (res) {\n          return res.json();\n        }).then(function (resJson) {\n          if (resJson.state === \"1\") {\n            _this3.$Message.success(resJson.msg);\n\n            _this3.getData();\n\n            _this3.marilynName = \"\";\n            _this3.marilynEnName = \"\";\n            _this3.marilynOrder = \"\";\n            _this3.addCard = false;\n          } else {\n            _this3.$Message.error(resJson.msg);\n          }\n        });\n      } else {\n        this.$Message.error(\"分类名称不要为空噢\");\n      }\n    },\n    toolDelete: function toolDelete() {\n      var _this4 = this;\n\n      this.modal_loading = true;\n      classDelete({\n        id: this.currentDelete\n      }).then(function (res) {\n        _this4.modal_loading = false;\n\n        if (res.state === \"1\") {\n          _this4.deleteModel = false;\n\n          _this4.$Message.success(res.msg);\n\n          _this4.getData();\n        } else {\n          _this4.$Message.error(res.msg);\n        }\n      });\n    },\n    toolEdit: function toolEdit() {\n      var _this5 = this;\n\n      this.modal_loading = true;\n      var data = new FormData();\n\n      if (this.currentImg) {\n        data.append(\"file\", this.currentImg);\n      }\n\n      data.append(\"id\", this.updateId);\n      data.append(\"name\", this.updateName);\n      data.append(\"alias\", this.updateEnName);\n      data.append(\"order\", this.updateOrder);\n      var option = {\n        method: \"post\",\n        body: data\n      };\n      fetch(classUpdate, option).then(function (res) {\n        return res.json();\n      }).then(function (resJson) {\n        _this5.modal_loading = false;\n\n        if (resJson.state === \"1\") {\n          _this5.$Message.success(resJson.msg);\n\n          _this5.updateId = \"\";\n          _this5.updateName = \"\";\n          _this5.updateEnName = \"\";\n          _this5.updateOrder = \"\";\n\n          _this5.getData();\n\n          _this5.editModel = false;\n        } else {\n          _this5.$Message.error(resJson.msg);\n        }\n      }); // classUpdate({\n      //   id: this.updateId,\n      //   name: this.updateName,\n      //   order: this.updateOrder\n      // }).then(res => {\n      //   this.modal_loading = false\n      //   if(res.state === \"1\") {\n      //     this.$Message.success(res.msg)\n      //     this.updateId = \"\"\n      //     this.updateName = \"\"\n      //     this.updateOrder = \"\"\n      //     this.getData()\n      //     this.editModel = false\n      //   } else {\n      //     this.$Message.error(res.msg)\n      //   }\n      // })\n    },\n    handleUpload: function handleUpload(file) {\n      var self = this;\n      var reader = new FileReader(),\n          img = new Image();\n      reader.readAsDataURL(file);\n\n      reader.onload = function (e) {\n        self.marilynimg = e.target.result;\n      };\n\n      this.file = file;\n    },\n    modifyUpload: function modifyUpload(e) {\n      var self = this;\n      this.currentImg = e.currentTarget.files[0];\n      var reader = new FileReader(),\n          img = new Image();\n      reader.readAsDataURL(this.currentImg);\n\n      reader.onload = function (e) {\n        document.querySelector(\".curtimg\").src = e.target.result;\n      };\n    }\n  }\n};",{"version":3,"sources":["Marilyn.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <Spin size=\"large\" fix v-if=\"spinShow\"></Spin>\r\n    <div class=\"marilyn_tab\">\r\n      <Card class=\"marilyn_card marilyn_upload\">\r\n        <div class=\"add_game_view\" @click=\"addCard = true\">\r\n          <img src=\"../../images/add.png\" style=\"height:150px;width:150px\">\r\n          <span style=\"display:block;text-align:center\">添加分类</span>\r\n        </div>\r\n      </Card>\r\n\r\n      <Card class=\"marilyn_card\" v-for=\"i in datalist\">\r\n        <div style=\"text-align:center\">\r\n          <img :src=\"gameImgurl + i.image\" class=\"marilyn_img\">\r\n          <h3 class=\"marilyn_name\">{{i.name}}</h3>\r\n          <p class=\"marilyn_num\">英文名: {{i.alias }}</p>\r\n          <p class=\"marilyn_num\">游戏数量: {{i.num}}</p>\r\n          <p class=\"marilyn_num\">排序: {{i.order}}</p>\r\n        </div>\r\n        <div class=\"marilyn_tools\">\r\n          <i\r\n            class=\"fas fa-trash-alt\"\r\n            style=\"cursor:pointer;color:#ed4014\"\r\n            @click=\"currentDelete = i.id; deleteModel = !deleteModel\"\r\n          ></i>\r\n          <i\r\n            class=\"far fa-edit\"\r\n            style=\"cursor:pointer\"\r\n            @click=\"updateImage = i.image;updateId = i.id; updateName = i.name;updateEnName =i.alias, updateOrder = i.order; editModel = !editModel\"\r\n          ></i>\r\n        </div>\r\n      </Card>\r\n    </div>\r\n\r\n    <Modal v-model=\"addCard\" width=\"360\" footer-hide>\r\n      <div style=\"text-align:center\" class=\"marilyn_up_card\">\r\n        <Upload\r\n          multiple\r\n          type=\"drag\"\r\n          :action=\"gameUpload\"\r\n          name=\"file\"\r\n          :on-success=\"uploadSuccess\"\r\n          :show-upload-list=\"false\"\r\n          :format=\"['jpg','jpeg','png','gif']\"\r\n          :before-upload=\"handleUpload\"\r\n        >\r\n          <div style=\"padding: 20px 0\">\r\n            <Icon type=\"ios-cloud-upload\" size=\"52\" style=\"color: #3399ff\"></Icon>\r\n            <p>单击或拖动图片到此处上传</p>\r\n          </div>\r\n          <img :src=\"marilynimg\" class=\"upload_image\" alt>\r\n        </Upload>\r\n      </div>\r\n\r\n      <div class=\"marilyn_margin\" style=\"text-align:center\">\r\n        <Input\r\n          class=\"judgename_add\"\r\n          prefix=\"ios-game-controller-b\"\r\n          placeholder=\"中文分类名字 ...\"\r\n          style=\"width: auto\"\r\n          v-model=\"marilynName\"\r\n        />\r\n      </div>\r\n      <div class=\"marilyn_margin\" style=\"text-align:center\">\r\n        <Input\r\n          prefix=\"ios-game-controller-b-outline\"\r\n          placeholder=\"英文分类名字 ...\"\r\n          style=\"width: auto\"\r\n          v-model=\"marilynEnName\"\r\n        />\r\n      </div>\r\n      <div class=\"marilyn_margin\" style=\"text-align:center\">\r\n        <Input placeholder=\"排序序号 ...\" style=\"width: auto\" v-model=\"marilynOrder\">\r\n          <Icon type=\"logo-buffer\" slot=\"prefix\"/>\r\n        </Input>\r\n        <p style=\"font-size:12px;color:#b3b3b3;\">*0默认，正整数从大到小排序</p>\r\n      </div>\r\n      <Button\r\n        v-show=\"btnAdd\"\r\n        ref=\"btn_add\"\r\n        type=\"primary\"\r\n        long\r\n        class=\"marilyn_margin\"\r\n        @click=\"addClass\"\r\n      >添加</Button>\r\n      <Button\r\n        v-show=\"!btnAdd\"\r\n        disabled\r\n        ref=\"btn_add\"\r\n        type=\"primary\"\r\n        long\r\n        class=\"marilyn_margin\"\r\n        @click=\"addClass\"\r\n      >添加</Button>\r\n    </Modal>\r\n    <Modal v-model=\"deleteModel\" width=\"360\">\r\n      <p slot=\"header\" style=\"color:#f60;text-align:center\">\r\n        <Icon type=\"ios-information-circle\"></Icon>\r\n        <span>删除确认</span>\r\n      </p>\r\n      <div style=\"text-align:center\">\r\n        <p>是否继续删除？</p>\r\n      </div>\r\n      <div slot=\"footer\">\r\n        <Button type=\"error\" size=\"large\" long :loading=\"modal_loading\" @click=\"toolDelete\">删除</Button>\r\n      </div>\r\n    </Modal>\r\n    <Modal v-model=\"editModel\" width=\"360\">\r\n      <p slot=\"header\" style=\"color:#2d8cf0;text-align:center\">\r\n        <span>修改</span>\r\n      </p>\r\n      <div style=\"text-align:center\">\r\n        <div style=\"position:relative;height:164px;width:100%\">\r\n          <input type=\"file\" class=\"inputfile\" name=\"file\" @change=\"modifyUpload\" id=\"fileImg\">\r\n          <img :src=\"gameImgurl + updateImage\" alt class=\"curtimg\">\r\n        </div>\r\n        <div>\r\n          中文名字 :\r\n          <Input\r\n            class=\"judgename_edit\"\r\n            prefix=\"logo-buffer\"\r\n            placeholder=\"分类名字 ...\"\r\n            style=\"width:auto;margin:10px 0\"\r\n            v-model=\"updateName\"\r\n          />\r\n        </div>\r\n        <div>\r\n          英文名字 :\r\n          <Input\r\n            prefix=\"logo-buffer\"\r\n            placeholder=\"分类名字 ...\"\r\n            style=\"width:auto;margin:10px 0\"\r\n            v-model=\"updateEnName\"\r\n          />\r\n        </div>\r\n        <div>\r\n          排&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp序 :\r\n          <Input placeholder=\"排序序号 ...\" style=\"width: auto;margin:10px 0\" v-model=\"updateOrder\">\r\n            <Icon type=\"logo-buffer\" slot=\"prefix\"/>\r\n          </Input>\r\n          <p style=\"font-size:12px;color:#b3b3b3;padding-left:30px\">*0默认，正整数从大到小排序</p>\r\n        </div>\r\n      </div>\r\n      <div slot=\"footer\">\r\n        <Button\r\n          v-show=\"btnEdit\"\r\n          ref=\"btn_edit\"\r\n          type=\"primary\"\r\n          size=\"large\"\r\n          long\r\n          :loading=\"modal_loading\"\r\n          @click=\"toolEdit\"\r\n        >确认</Button>\r\n        <Button\r\n          v-show=\"!btnEdit\"\r\n          disabled\r\n          ref=\"btn_edit\"\r\n          type=\"primary\"\r\n          size=\"large\"\r\n          long\r\n          :loading=\"modal_loading\"\r\n          @click=\"toolEdit\"\r\n        >确认</Button>\r\n      </div>\r\n    </Modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  classIndex,\r\n  classAdd,\r\n  classDelete,\r\n  classUpdate,\r\n  gameImgurl,\r\n  judgeName,\r\n  onfocus,\r\n  onblur\r\n} from \"@/api/index\";\r\nimport { setTimeout } from \"timers\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      btnAdd: true,\r\n      btnEdit: true,\r\n      datalist: [],\r\n      marilynName: \"\",\r\n      marilynEnName: \"\",\r\n      marilynOrder: \"\",\r\n      addCard: false,\r\n      deleteModel: false,\r\n      modal_loading: false,\r\n      currentDelete: \"\",\r\n      editState: false, // 关闭状态\r\n      editModel: false,\r\n      updateName: \"\",\r\n      updateEnName: \"\",\r\n      updateOrder: \"\",\r\n      updateId: \"\",\r\n      spinShow: true,\r\n      gameUpload: \"\",\r\n      marilynimg: \"\",\r\n      updateImage: \"\",\r\n      gameImgurl: \"\"\r\n    };\r\n  },\r\n  mounted() {\r\n    var judgename_add = document\r\n      .querySelector(\".judgename_add\")\r\n      .querySelector(\"input\");\r\n    var judgename_edit = document\r\n      .querySelector(\".judgename_edit\")\r\n      .querySelector(\"input\");\r\n\r\n    onfocus(judgename_add, () => {\r\n      judgename_add.style.border = \"1px solid #2d8cf0\";\r\n      this.btnAdd = true;\r\n    });\r\n    onblur(judgename_add, () => {\r\n      judgeName({ name: this.marilynName, type: \"class\" }).then(res => {\r\n        if (res.state == 0) {\r\n          if (this.addCard) {\r\n            this.btnAdd = false;\r\n            this.$Message.error(\"名字为空或该名字已存在\");\r\n            judgename_add.style.border = \"1px solid red\";\r\n            setTimeout(() => {\r\n              judgename_add.style.border = \"1px solid #dcdee2\";\r\n            }, 2000);\r\n          }\r\n        }\r\n      });\r\n    });\r\n    onfocus(judgename_edit, () => {\r\n      judgename_edit.style.border = \"1px solid #2d8cf0\";\r\n      this.btnEdit = true;\r\n    });\r\n    onblur(judgename_edit, () => {\r\n      judgeName({\r\n        name: this.updateName,\r\n        type: \"class\",\r\n        id: this.updateId\r\n      }).then(res => {\r\n        if (res.state == 0) {\r\n          if (this.editModel) {\r\n\r\n            this.btnEdit = false;\r\n            this.$Message.error(\"名字为空或该名字已存在\");\r\n            judgename_edit.style.border = \"1px solid red\";\r\n            setTimeout(() => {\r\n              judgename_edit.style.border = \"1px solid #dcdee2\";\r\n            }, 2000);\r\n          }\r\n        }\r\n      });\r\n    });\r\n\r\n    this.gameImgurl = gameImgurl;\r\n    this.getData();\r\n  },\r\n  watch: {\r\n    $route(to, from) {},\r\n    addCard(value) {\r\n      this.btnAdd = true;\r\n    },\r\n    editModel(value){\r\n      this.btnEdit = true;\r\n    }\r\n  },\r\n  methods: {\r\n    getData() {\r\n      this.spinShow = true;\r\n      classIndex().then(res => {\r\n        if (res.state === \"1\") {\r\n          this.datalist = res.msg;\r\n          this.spinShow = false;\r\n        }\r\n      });\r\n    },\r\n    uploadSuccess(res, file) {},\r\n    addClass() {\r\n      if (this.marilynName.trim().length !== 0) {\r\n        let data = new FormData();\r\n        data.append(\"file\", this.file);\r\n        data.append(\"name\", this.marilynName);\r\n        data.append(\"alias\", this.marilynEnName);\r\n        data.append(\"order\", this.marilynOrder || this.datalist.length + 1);\r\n        const option = {\r\n          method: \"post\",\r\n          body: data\r\n        };\r\n        fetch(classAdd, option)\r\n          .then(res => res.json())\r\n          .then(resJson => {\r\n            if (resJson.state === \"1\") {\r\n              this.$Message.success(resJson.msg);\r\n              this.getData();\r\n              this.marilynName = \"\";\r\n              this.marilynEnName = \"\";\r\n              this.marilynOrder = \"\";\r\n              this.addCard = false;\r\n            } else {\r\n              this.$Message.error(resJson.msg);\r\n            }\r\n          });\r\n      } else {\r\n        this.$Message.error(\"分类名称不要为空噢\");\r\n      }\r\n    },\r\n    toolDelete() {\r\n      this.modal_loading = true;\r\n      classDelete({\r\n        id: this.currentDelete\r\n      }).then(res => {\r\n        this.modal_loading = false;\r\n        if (res.state === \"1\") {\r\n          this.deleteModel = false;\r\n          this.$Message.success(res.msg);\r\n          this.getData();\r\n        } else {\r\n          this.$Message.error(res.msg);\r\n        }\r\n      });\r\n    },\r\n    toolEdit() {\r\n      this.modal_loading = true;\r\n      let data = new FormData();\r\n      if (this.currentImg) {\r\n        data.append(\"file\", this.currentImg);\r\n      }\r\n      data.append(\"id\", this.updateId);\r\n      data.append(\"name\", this.updateName);\r\n      data.append(\"alias\", this.updateEnName);\r\n      data.append(\"order\", this.updateOrder);\r\n      const option = {\r\n        method: \"post\",\r\n        body: data\r\n      };\r\n      fetch(classUpdate, option)\r\n        .then(res => res.json())\r\n        .then(resJson => {\r\n          this.modal_loading = false;\r\n          if (resJson.state === \"1\") {\r\n            this.$Message.success(resJson.msg);\r\n            this.updateId = \"\";\r\n            this.updateName = \"\";\r\n            this.updateEnName = \"\";\r\n            this.updateOrder = \"\";\r\n            this.getData();\r\n            this.editModel = false;\r\n          } else {\r\n            this.$Message.error(resJson.msg);\r\n          }\r\n        });\r\n      // classUpdate({\r\n      //   id: this.updateId,\r\n      //   name: this.updateName,\r\n      //   order: this.updateOrder\r\n      // }).then(res => {\r\n      //   this.modal_loading = false\r\n      //   if(res.state === \"1\") {\r\n      //     this.$Message.success(res.msg)\r\n      //     this.updateId = \"\"\r\n      //     this.updateName = \"\"\r\n      //     this.updateOrder = \"\"\r\n      //     this.getData()\r\n      //     this.editModel = false\r\n      //   } else {\r\n      //     this.$Message.error(res.msg)\r\n      //   }\r\n      // })\r\n    },\r\n    handleUpload(file) {\r\n      var self = this;\r\n      var reader = new FileReader(),\r\n        img = new Image();\r\n      reader.readAsDataURL(file);\r\n      reader.onload = function(e) {\r\n        self.marilynimg = e.target.result;\r\n      };\r\n      this.file = file;\r\n    },\r\n    modifyUpload(e) {\r\n      var self = this;\r\n      this.currentImg = e.currentTarget.files[0];\r\n      var reader = new FileReader(),\r\n        img = new Image();\r\n      reader.readAsDataURL(this.currentImg);\r\n      reader.onload = function(e) {\r\n        document.querySelector(\".curtimg\").src = e.target.result;\r\n      };\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n.upload_image {\r\n  position: absolute;\r\n  top: 0;\r\n  height: 100%;\r\n}\r\n\r\n.inputfile {\r\n  height: 164px;\r\n  width: 164px;\r\n  position: absolute;\r\n  top: 0;\r\n  opacity: 0;\r\n}\r\n\r\n.curtimg {\r\n  height: 164px;\r\n  width: 164px;\r\n}\r\n</style>\r\n\r\n\r\n"],"sourceRoot":"src/views/Manage"}]}
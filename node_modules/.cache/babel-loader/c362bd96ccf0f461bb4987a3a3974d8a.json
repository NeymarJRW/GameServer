{"remainingRequest":"/Users/gaga/Desktop/GameServer/node_modules/thread-loader/dist/cjs.js!/Users/gaga/Desktop/GameServer/node_modules/babel-loader/lib/index.js!/Users/gaga/Desktop/GameServer/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/gaga/Desktop/GameServer/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gaga/Desktop/GameServer/src/views/Manage/Recom_game.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/gaga/Desktop/GameServer/src/views/Manage/Recom_game.vue","mtime":1574655045079},{"path":"/Users/gaga/Desktop/GameServer/node_modules/cache-loader/dist/cjs.js","mtime":1558076220000},{"path":"/Users/gaga/Desktop/GameServer/node_modules/thread-loader/dist/cjs.js","mtime":1557114192000},{"path":"/Users/gaga/Desktop/GameServer/node_modules/babel-loader/lib/index.js","mtime":1557114185000},{"path":"/Users/gaga/Desktop/GameServer/node_modules/cache-loader/dist/cjs.js","mtime":1558076220000},{"path":"/Users/gaga/Desktop/GameServer/node_modules/vue-loader/lib/index.js","mtime":1557114192000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { gameRecommend, platformRecommend, recomGameadd, pinjieUrl, recomGameedit } from \"@/api/index.js\";\nimport { Msg } from \"@/api/data.js\";\nimport { log } from \"util\";\nexport default {\n  data: function data() {\n    var _this = this;\n\n    return {\n      editflag: false,\n      addflag: false,\n      uploadsrc: \"\",\n      id: \"\",\n      name: \"\",\n      bundle: \"\",\n      version: \"\",\n      icon: null,\n      platform: \"\",\n      platformarr: [],\n      columns: [{\n        title: \"ID\",\n        key: \"id\",\n        width: 80\n      }, {\n        title: \"图像\",\n        key: \"icon\",\n        width: 80,\n        render: function render(h, params) {\n          return h(\"div\", [h(\"Avatar\", {\n            props: {\n              shape: \"square\",\n              // src: params.row.icon\n              src: pinjieUrl + params.row.icon\n            }\n          })]);\n        }\n      }, {\n        title: \"名称\",\n        key: \"name\",\n        width: 150\n      }, {\n        title: \"版本\",\n        key: \"version\",\n        width: 150\n      }, {\n        title: \"Bundle\",\n        key: \"bundle\"\n      }, {\n        title: \"平台\",\n        key: \"platform\"\n      }, {\n        title: \"操作\",\n        key: \"action\",\n        // width: 200,\n        align: \"center\",\n        render: function render(h, params) {\n          return h(\"div\", [h(\"Button\", {\n            props: {\n              type: \"primary\",\n              size: \"small\"\n            },\n            style: {\n              marginRight: \"5px\"\n            },\n            on: {\n              click: function click() {\n                _this.editflag = true;\n                console.log(params.row);\n                _this.id = params.row.id;\n                _this.name = params.row.name;\n                _this.bundle = params.row.bundle;\n                _this.version = params.row.version;\n                _this.uploadsrc = pinjieUrl + params.row.icon; // this.icon = params.row.icon;\n\n                _this.platform = params.row.platform;\n              }\n            }\n          }, \"修改\")]);\n        }\n      }],\n      gamedata: [],\n      //所有游戏\n      total: 0,\n      //一共几条数据\n      pagesize: 5,\n      //一页几条数据\n      tableloading: false,\n      pagedata: []\n    };\n  },\n  watch: {\n    editflag: function editflag(val) {\n      if (!val) {\n        this.id = \"\";\n        this.name = \"\";\n        this.bundle = \"\";\n        this.version = \"\";\n        this.icon = null;\n        this.platform = \"\";\n        this.uploadsrc = \"\";\n      }\n    },\n    addflag: function addflag(val) {\n      if (!val) {\n        this.id = \"\";\n        this.name = \"\";\n        this.bundle = \"\";\n        this.version = \"\";\n        this.icon = null;\n        this.platform = \"\";\n        this.uploadsrc = \"\";\n      }\n    }\n  },\n  mounted: function mounted() {\n    this.getdata();\n  },\n  methods: {\n    getdata: function getdata() {\n      var _this2 = this;\n\n      this.tableloading = true;\n      gameRecommend().then(function (res) {\n        _this2.tableloading = false;\n        _this2.total = res.msg.length;\n        _this2.gamedata = res.msg;\n        _this2.pagedata = _this2.gamedata.slice(0, _this2.pagesize);\n      });\n      platformRecommend().then(function (res) {\n        // console.log(res);\n        _this2.platformarr = res.msg;\n      });\n    },\n    pagechange: function pagechange(index) {\n      var _start = (index - 1) * this.pagesize;\n\n      var _end = index * this.pagesize;\n\n      this.pagedata = this.gamedata.slice(_start, _end);\n    },\n    handleUpload: function handleUpload(file) {\n      var self = this; // console.log(file);\n\n      var reader = new FileReader(),\n          img = new Image();\n      reader.readAsDataURL(file);\n\n      reader.onload = function () {\n        // console.log(this.result);\n        self.uploadsrc = this.result;\n      };\n\n      this.icon = file;\n    },\n    editGame: function editGame() {\n      var _this3 = this;\n\n      if (this.bundle.length > 0 && this.name.length > 0 && this.version.length > 0 && this.platform.length > 0) {\n        var data = new FormData();\n        data.append(\"id\", this.id);\n        data.append(\"bundle\", this.bundle);\n        data.append(\"name\", this.name);\n        data.append(\"version\", this.version);\n        data.append(\"platform\", this.platform);\n\n        if (this.icon) {\n          data.append(\"icon\", this.icon);\n        }\n\n        var option = {\n          method: \"post\",\n          body: data\n        };\n        fetch(recomGameedit, option).then(function (res) {\n          return res.json();\n        }).then(function (resJson) {\n          if (resJson.state === \"1\") {\n            _this3.editflag = false;\n\n            _this3.$Message.success(resJson.msg);\n\n            _this3.getdata();\n          } else {\n            _this3.$Message.error(resJson.msg);\n          }\n        });\n      } else {\n        this.$Message.error(\"修改失败\");\n      }\n    },\n    addGame: function addGame() {\n      var _this4 = this;\n\n      if (this.bundle.length > 0 && this.name.length > 0 && this.version.length > 0 && this.platform.length > 0 && this.icon) {\n        var data = new FormData();\n        data.append(\"bundle\", this.bundle);\n        data.append(\"name\", this.name);\n        data.append(\"version\", this.version);\n        data.append(\"platform\", this.platform);\n        data.append(\"icon\", this.icon);\n        var option = {\n          method: \"post\",\n          body: data\n        };\n        fetch(recomGameadd, option).then(function (res) {\n          return res.json();\n        }).then(function (resJson) {\n          if (resJson.state === \"1\") {\n            _this4.addflag = false;\n\n            _this4.$Message.success(resJson.msg);\n\n            _this4.getdata();\n          } else {\n            _this4.$Message.error(resJson.msg);\n          }\n        });\n      } else {\n        this.$Message.error(\"添加失败\");\n      }\n    }\n  }\n};",{"version":3,"sources":["Recom_game.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0GA,SACA,aADA,EAEA,iBAFA,EAGA,YAHA,EAIA,SAJA,EAKA,aALA,QAMA,gBANA;AAOA,SAAA,GAAA,QAAA,eAAA;AACA,SAAA,GAAA,QAAA,MAAA;AACA,eAAA;AACA,EAAA,IADA,kBACA;AAAA;;AACA,WAAA;AACA,MAAA,QAAA,EAAA,KADA;AAEA,MAAA,OAAA,EAAA,KAFA;AAGA,MAAA,SAAA,EAAA,EAHA;AAKA,MAAA,EAAA,EAAA,EALA;AAMA,MAAA,IAAA,EAAA,EANA;AAOA,MAAA,MAAA,EAAA,EAPA;AAQA,MAAA,OAAA,EAAA,EARA;AASA,MAAA,IAAA,EAAA,IATA;AAUA,MAAA,QAAA,EAAA,EAVA;AAYA,MAAA,WAAA,EAAA,EAZA;AAaA,MAAA,OAAA,EAAA,CACA;AACA,QAAA,KAAA,EAAA,IADA;AAEA,QAAA,GAAA,EAAA,IAFA;AAGA,QAAA,KAAA,EAAA;AAHA,OADA,EAMA;AACA,QAAA,KAAA,EAAA,IADA;AAEA,QAAA,GAAA,EAAA,MAFA;AAGA,QAAA,KAAA,EAAA,EAHA;AAIA,QAAA,MAAA,EAAA,gBAAA,CAAA,EAAA,MAAA,EAAA;AACA,iBAAA,CAAA,CAAA,KAAA,EAAA,CACA,CAAA,CAAA,QAAA,EAAA;AACA,YAAA,KAAA,EAAA;AACA,cAAA,KAAA,EAAA,QADA;AAEA;AACA,cAAA,GAAA,EAAA,SAAA,GAAA,MAAA,CAAA,GAAA,CAAA;AAHA;AADA,WAAA,CADA,CAAA,CAAA;AASA;AAdA,OANA,EAsBA;AACA,QAAA,KAAA,EAAA,IADA;AAEA,QAAA,GAAA,EAAA,MAFA;AAGA,QAAA,KAAA,EAAA;AAHA,OAtBA,EA2BA;AACA,QAAA,KAAA,EAAA,IADA;AAEA,QAAA,GAAA,EAAA,SAFA;AAGA,QAAA,KAAA,EAAA;AAHA,OA3BA,EAgCA;AACA,QAAA,KAAA,EAAA,QADA;AAEA,QAAA,GAAA,EAAA;AAFA,OAhCA,EAoCA;AACA,QAAA,KAAA,EAAA,IADA;AAEA,QAAA,GAAA,EAAA;AAFA,OApCA,EAwCA;AACA,QAAA,KAAA,EAAA,IADA;AAEA,QAAA,GAAA,EAAA,QAFA;AAGA;AACA,QAAA,KAAA,EAAA,QAJA;AAKA,QAAA,MAAA,EAAA,gBAAA,CAAA,EAAA,MAAA,EAAA;AACA,iBAAA,CAAA,CAAA,KAAA,EAAA,CACA,CAAA,CACA,QADA,EAEA;AACA,YAAA,KAAA,EAAA;AACA,cAAA,IAAA,EAAA,SADA;AAEA,cAAA,IAAA,EAAA;AAFA,aADA;AAKA,YAAA,KAAA,EAAA;AACA,cAAA,WAAA,EAAA;AADA,aALA;AAQA,YAAA,EAAA,EAAA;AACA,cAAA,KAAA,EAAA,iBAAA;AACA,gBAAA,KAAA,CAAA,QAAA,GAAA,IAAA;AACA,gBAAA,OAAA,CAAA,GAAA,CAAA,MAAA,CAAA,GAAA;AACA,gBAAA,KAAA,CAAA,EAAA,GAAA,MAAA,CAAA,GAAA,CAAA,EAAA;AACA,gBAAA,KAAA,CAAA,IAAA,GAAA,MAAA,CAAA,GAAA,CAAA,IAAA;AACA,gBAAA,KAAA,CAAA,MAAA,GAAA,MAAA,CAAA,GAAA,CAAA,MAAA;AACA,gBAAA,KAAA,CAAA,OAAA,GAAA,MAAA,CAAA,GAAA,CAAA,OAAA;AACA,gBAAA,KAAA,CAAA,SAAA,GAAA,SAAA,GAAA,MAAA,CAAA,GAAA,CAAA,IAAA,CAPA,CAQA;;AACA,gBAAA,KAAA,CAAA,QAAA,GAAA,MAAA,CAAA,GAAA,CAAA,QAAA;AACA;AAXA;AARA,WAFA,EAwBA,IAxBA,CADA,CAAA,CAAA;AA4BA;AAlCA,OAxCA,CAbA;AA0FA,MAAA,QAAA,EAAA,EA1FA;AA0FA;AACA,MAAA,KAAA,EAAA,CA3FA;AA2FA;AACA,MAAA,QAAA,EAAA,CA5FA;AA4FA;AACA,MAAA,YAAA,EAAA,KA7FA;AA8FA,MAAA,QAAA,EAAA;AA9FA,KAAA;AAgGA,GAlGA;AAmGA,EAAA,KAAA,EAAA;AACA,IAAA,QADA,oBACA,GADA,EACA;AAGA,UAAA,CAAA,GAAA,EAAA;AACA,aAAA,EAAA,GAAA,EAAA;AACA,aAAA,IAAA,GAAA,EAAA;AACA,aAAA,MAAA,GAAA,EAAA;AACA,aAAA,OAAA,GAAA,EAAA;AACA,aAAA,IAAA,GAAA,IAAA;AACA,aAAA,QAAA,GAAA,EAAA;AACA,aAAA,SAAA,GAAA,EAAA;AACA;AACA,KAbA;AAcA,IAAA,OAdA,mBAcA,GAdA,EAcA;AAGA,UAAA,CAAA,GAAA,EAAA;AACA,aAAA,EAAA,GAAA,EAAA;AACA,aAAA,IAAA,GAAA,EAAA;AACA,aAAA,MAAA,GAAA,EAAA;AACA,aAAA,OAAA,GAAA,EAAA;AACA,aAAA,IAAA,GAAA,IAAA;AACA,aAAA,QAAA,GAAA,EAAA;AACA,aAAA,SAAA,GAAA,EAAA;AAEA;AACA;AA3BA,GAnGA;AAgIA,EAAA,OAhIA,qBAgIA;AACA,SAAA,OAAA;AACA,GAlIA;AAmIA,EAAA,OAAA,EAAA;AACA,IAAA,OADA,qBACA;AAAA;;AAEA,WAAA,YAAA,GAAA,IAAA;AACA,MAAA,aAAA,GAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,MAAA,CAAA,YAAA,GAAA,KAAA;AACA,QAAA,MAAA,CAAA,KAAA,GAAA,GAAA,CAAA,GAAA,CAAA,MAAA;AACA,QAAA,MAAA,CAAA,QAAA,GAAA,GAAA,CAAA,GAAA;AACA,QAAA,MAAA,CAAA,QAAA,GAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,CAAA,EAAA,MAAA,CAAA,QAAA,CAAA;AACA,OALA;AAMA,MAAA,iBAAA,GAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA;AACA,QAAA,MAAA,CAAA,WAAA,GAAA,GAAA,CAAA,GAAA;AACA,OAHA;AAIA,KAdA;AAeA,IAAA,UAfA,sBAeA,KAfA,EAeA;AACA,UAAA,MAAA,GAAA,CAAA,KAAA,GAAA,CAAA,IAAA,KAAA,QAAA;;AACA,UAAA,IAAA,GAAA,KAAA,GAAA,KAAA,QAAA;;AACA,WAAA,QAAA,GAAA,KAAA,QAAA,CAAA,KAAA,CAAA,MAAA,EAAA,IAAA,CAAA;AACA,KAnBA;AAoBA,IAAA,YApBA,wBAoBA,IApBA,EAoBA;AACA,UAAA,IAAA,GAAA,IAAA,CADA,CAEA;;AACA,UAAA,MAAA,GAAA,IAAA,UAAA,EAAA;AAAA,UACA,GAAA,GAAA,IAAA,KAAA,EADA;AAEA,MAAA,MAAA,CAAA,aAAA,CAAA,IAAA;;AACA,MAAA,MAAA,CAAA,MAAA,GAAA,YAAA;AACA;AACA,QAAA,IAAA,CAAA,SAAA,GAAA,KAAA,MAAA;AACA,OAHA;;AAIA,WAAA,IAAA,GAAA,IAAA;AACA,KA/BA;AAgCA,IAAA,QAhCA,sBAgCA;AAAA;;AACA,UACA,KAAA,MAAA,CAAA,MAAA,GAAA,CAAA,IACA,KAAA,IAAA,CAAA,MAAA,GAAA,CADA,IAEA,KAAA,OAAA,CAAA,MAAA,GAAA,CAFA,IAGA,KAAA,QAAA,CAAA,MAAA,GAAA,CAJA,EAKA;AACA,YAAA,IAAA,GAAA,IAAA,QAAA,EAAA;AACA,QAAA,IAAA,CAAA,MAAA,CAAA,IAAA,EAAA,KAAA,EAAA;AACA,QAAA,IAAA,CAAA,MAAA,CAAA,QAAA,EAAA,KAAA,MAAA;AACA,QAAA,IAAA,CAAA,MAAA,CAAA,MAAA,EAAA,KAAA,IAAA;AACA,QAAA,IAAA,CAAA,MAAA,CAAA,SAAA,EAAA,KAAA,OAAA;AACA,QAAA,IAAA,CAAA,MAAA,CAAA,UAAA,EAAA,KAAA,QAAA;;AACA,YAAA,KAAA,IAAA,EAAA;AACA,UAAA,IAAA,CAAA,MAAA,CAAA,MAAA,EAAA,KAAA,IAAA;AACA;;AACA,YAAA,MAAA,GAAA;AACA,UAAA,MAAA,EAAA,MADA;AAEA,UAAA,IAAA,EAAA;AAFA,SAAA;AAIA,QAAA,KAAA,CAAA,aAAA,EAAA,MAAA,CAAA,CACA,IADA,CACA,UAAA,GAAA;AAAA,iBAAA,GAAA,CAAA,IAAA,EAAA;AAAA,SADA,EAEA,IAFA,CAEA,UAAA,OAAA,EAAA;AACA,cAAA,OAAA,CAAA,KAAA,KAAA,GAAA,EAAA;AACA,YAAA,MAAA,CAAA,QAAA,GAAA,KAAA;;AACA,YAAA,MAAA,CAAA,QAAA,CAAA,OAAA,CAAA,OAAA,CAAA,GAAA;;AACA,YAAA,MAAA,CAAA,OAAA;AACA,WAJA,MAIA;AACA,YAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,OAAA,CAAA,GAAA;AACA;AACA,SAVA;AAWA,OA9BA,MA8BA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,MAAA;AACA;AACA,KAlEA;AAmEA,IAAA,OAnEA,qBAmEA;AAAA;;AACA,UACA,KAAA,MAAA,CAAA,MAAA,GAAA,CAAA,IACA,KAAA,IAAA,CAAA,MAAA,GAAA,CADA,IAEA,KAAA,OAAA,CAAA,MAAA,GAAA,CAFA,IAGA,KAAA,QAAA,CAAA,MAAA,GAAA,CAHA,IAIA,KAAA,IALA,EAMA;AACA,YAAA,IAAA,GAAA,IAAA,QAAA,EAAA;AACA,QAAA,IAAA,CAAA,MAAA,CAAA,QAAA,EAAA,KAAA,MAAA;AACA,QAAA,IAAA,CAAA,MAAA,CAAA,MAAA,EAAA,KAAA,IAAA;AACA,QAAA,IAAA,CAAA,MAAA,CAAA,SAAA,EAAA,KAAA,OAAA;AACA,QAAA,IAAA,CAAA,MAAA,CAAA,UAAA,EAAA,KAAA,QAAA;AACA,QAAA,IAAA,CAAA,MAAA,CAAA,MAAA,EAAA,KAAA,IAAA;AACA,YAAA,MAAA,GAAA;AACA,UAAA,MAAA,EAAA,MADA;AAEA,UAAA,IAAA,EAAA;AAFA,SAAA;AAIA,QAAA,KAAA,CAAA,YAAA,EAAA,MAAA,CAAA,CACA,IADA,CACA,UAAA,GAAA;AAAA,iBAAA,GAAA,CAAA,IAAA,EAAA;AAAA,SADA,EAEA,IAFA,CAEA,UAAA,OAAA,EAAA;AACA,cAAA,OAAA,CAAA,KAAA,KAAA,GAAA,EAAA;AACA,YAAA,MAAA,CAAA,OAAA,GAAA,KAAA;;AACA,YAAA,MAAA,CAAA,QAAA,CAAA,OAAA,CAAA,OAAA,CAAA,GAAA;;AACA,YAAA,MAAA,CAAA,OAAA;AACA,WAJA,MAIA;AACA,YAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,OAAA,CAAA,GAAA;AACA;AACA,SAVA;AAWA,OA5BA,MA4BA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,MAAA;AACA;AACA;AAnGA;AAnIA,CAAA","sourcesContent":["<template>\n  <div class=\"recommend\">\n    <Button class=\"addbtn\" type=\"primary\" @click=\"addflag = true\">添加游戏</Button>\n\n    <Table class=\"table\" :loading=\"tableloading\" stripe border :columns=\"columns\" :data=\"pagedata\"></Table>\n    <Page\n      style=\"text-align:center;margin-top:10px\"\n      :total=\"total\"\n      :page-size=\"pagesize\"\n      @on-change=\"pagechange\"\n    />\n    <!-- <Poptip trigger=\"hover\" placement=\"right\" >\n        <img style=\"width:50px\" src=\"http://img4.imgtn.bdimg.com/it/u=1485081754,2164381578&fm=26&gp=0.jpg\" alt=\"\">\n        <div class=\"api\" slot=\"content\">\n          <img style=\"width:200px\" src=\"http://img4.imgtn.bdimg.com/it/u=1485081754,2164381578&fm=26&gp=0.jpg\" alt=\"\">\n\n        </div>\n    </Poptip>-->\n\n    <!-- 添加游戏 -->\n    <Modal v-model=\"addflag\" width=\"600\">\n      <p slot=\"header\" style=\"text-align:center\">\n        <span>添加游戏</span>\n      </p>\n      <div class=\"addgame\">\n        名称:\n        <Input v-model=\"name\" placeholder=\"请输入游戏名称...\" style=\"width: 400px\" />\n      </div>\n      <div class=\"addgame\">\n        bundle:\n        <Input v-model=\"bundle\" placeholder=\"请输入游戏标识...\" style=\"width: 400px\" />\n      </div>\n      <div class=\"addgame\">\n        版本:\n        <Input v-model=\"version\" placeholder=\"请输入游戏版本...\" style=\"width: 400px\" />\n      </div>\n      <div class=\"addgame\">\n        平台:\n        <Select v-model=\"platform\" style=\"width:400px\">\n          <Option v-for=\"item in platformarr\" :value=\"item.platform\" :key=\"item.id\">{{ item.name }}</Option>\n        </Select>\n      </div>\n      <div class=\"addgame\">\n        <Upload\n          style=\"margin:0 40px\"\n          :before-upload=\"handleUpload\"\n          type=\"drag\"\n          action=\"//jsonplaceholder.typicode.com/posts/\"\n        >\n          <div style=\"padding: 20px 0\">\n            <Icon type=\"ios-cloud-upload\" size=\"52\" style=\"color: #3399ff\"></Icon>\n            <p>点击此处上传你的头像</p>\n          </div>\n          <img :src=\"uploadsrc\" class=\"upload_image\" alt />\n        </Upload>\n      </div>\n      <div slot=\"footer\">\n        <Button type=\"primary\" size=\"large\" long @click=\"addGame\">添加</Button>\n      </div>\n    </Modal>\n\n    <!-- 修改游戏 -->\n    <Modal v-model=\"editflag\" width=\"600\">\n      <p slot=\"header\" style=\"text-align:center\">\n        <span>修改游戏</span>\n      </p>\n      <div class=\"addgame\">\n        名称:\n        <Input v-model=\"name\" placeholder=\"请输入游戏名称...\" style=\"width: 400px\" />\n      </div>\n      <div class=\"addgame\">\n        bundle:\n        <Input v-model=\"bundle\" placeholder=\"请输入游戏标识...\" style=\"width: 400px\" />\n      </div>\n      <div class=\"addgame\">\n        版本:\n        <Input v-model=\"version\" placeholder=\"请输入游戏版本...\" style=\"width: 400px\" />\n      </div>\n      <div class=\"addgame\">\n        平台:\n        <Select v-model=\"platform\" style=\"width:400px\">\n          <Option v-for=\"item in platformarr\" :value=\"item.platform\" :key=\"item.id\">{{ item.name }}</Option>\n        </Select>\n      </div>\n      <div class=\"addgame\">\n        <Upload\n          style=\"margin:0 40px\"\n          :before-upload=\"handleUpload\"\n          type=\"drag\"\n          action=\"//jsonplaceholder.typicode.com/posts/\"\n        >\n          <div style=\"padding: 20px 0\">\n            <Icon type=\"ios-cloud-upload\" size=\"52\" style=\"color: #3399ff\"></Icon>\n            <p>点击此处上传你的头像</p>\n          </div>\n          <img :src=\"uploadsrc\" class=\"upload_image\" alt />\n        </Upload>\n      </div>\n      <div slot=\"footer\">\n        <Button type=\"primary\" size=\"large\" long @click=\"editGame\">修改</Button>\n      </div>\n    </Modal>\n  </div>\n</template>\n\n<script>\nimport {\n  gameRecommend,\n  platformRecommend,\n  recomGameadd,\n  pinjieUrl,\n  recomGameedit\n} from \"@/api/index.js\";\nimport { Msg } from \"@/api/data.js\";\nimport { log } from \"util\";\nexport default {\n  data() {\n    return {\n      editflag: false,\n      addflag: false,\n      uploadsrc: \"\",\n\n      id: \"\",\n      name: \"\",\n      bundle: \"\",\n      version: \"\",\n      icon: null,\n      platform: \"\",\n\n      platformarr: [],\n      columns: [\n        {\n          title: \"ID\",\n          key: \"id\",\n          width: 80\n        },\n        {\n          title: \"图像\",\n          key: \"icon\",\n          width: 80,\n          render: (h, params) => {\n            return h(\"div\", [\n              h(\"Avatar\", {\n                props: {\n                  shape: \"square\",\n                  // src: params.row.icon\n                  src: pinjieUrl + params.row.icon\n                }\n              })\n            ]);\n          }\n        },\n        {\n          title: \"名称\",\n          key: \"name\",\n          width: 150\n        },\n        {\n          title: \"版本\",\n          key: \"version\",\n          width: 150\n        },\n        {\n          title: \"Bundle\",\n          key: \"bundle\"\n        },\n        {\n          title: \"平台\",\n          key: \"platform\"\n        },\n        {\n          title: \"操作\",\n          key: \"action\",\n          // width: 200,\n          align: \"center\",\n          render: (h, params) => {\n            return h(\"div\", [\n              h(\n                \"Button\",\n                {\n                  props: {\n                    type: \"primary\",\n                    size: \"small\"\n                  },\n                  style: {\n                    marginRight: \"5px\"\n                  },\n                  on: {\n                    click: () => {\n                      this.editflag = true;\n                      console.log(params.row);\n                      this.id = params.row.id;\n                      this.name = params.row.name;\n                      this.bundle = params.row.bundle;\n                      this.version = params.row.version;\n                      this.uploadsrc = pinjieUrl + params.row.icon;\n                      // this.icon = params.row.icon;\n                      this.platform = params.row.platform;\n                    }\n                  }\n                },\n                \"修改\"\n              )\n            ]);\n          }\n        }\n      ],\n      gamedata: [], //所有游戏\n      total: 0, //一共几条数据\n      pagesize: 5, //一页几条数据\n      tableloading: false,\n      pagedata: []\n    };\n  },\n  watch: {\n    editflag(val) {\n\n\n      if (!val) {\n        this.id = \"\";\n        this.name = \"\";\n        this.bundle = \"\";\n        this.version = \"\";\n        this.icon = null;\n        this.platform = \"\";\n        this.uploadsrc=\"\";\n      }\n    },\n    addflag(val) {\n\n\n      if (!val) {\n        this.id = \"\";\n        this.name = \"\";\n        this.bundle = \"\";\n        this.version = \"\";\n        this.icon = null;\n        this.platform = \"\";\n        this.uploadsrc=\"\";\n\n      }\n    }\n  },\n  mounted() {\n    this.getdata();\n  },\n  methods: {\n    getdata() {\n\n      this.tableloading = true;\n      gameRecommend().then(res => {\n        this.tableloading = false;\n        this.total = res.msg.length;\n        this.gamedata = res.msg;\n        this.pagedata = this.gamedata.slice(0, this.pagesize);\n      });\n      platformRecommend().then(res => {\n        // console.log(res);\n        this.platformarr = res.msg;\n      });\n    },\n    pagechange(index) {\n      var _start = (index - 1) * this.pagesize;\n      var _end = index * this.pagesize;\n      this.pagedata = this.gamedata.slice(_start, _end);\n    },\n    handleUpload(file) {\n      var self = this;\n      // console.log(file);\n      var reader = new FileReader(),\n        img = new Image();\n      reader.readAsDataURL(file);\n      reader.onload = function() {\n        // console.log(this.result);\n        self.uploadsrc = this.result;\n      };\n      this.icon = file;\n    },\n    editGame() {\n      if (\n        this.bundle.length > 0 &&\n        this.name.length > 0 &&\n        this.version.length > 0 &&\n        this.platform.length > 0\n      ) {\n        let data = new FormData();\n        data.append(\"id\", this.id);\n        data.append(\"bundle\", this.bundle);\n        data.append(\"name\", this.name);\n        data.append(\"version\", this.version);\n        data.append(\"platform\", this.platform);\n        if (this.icon) {\n          data.append(\"icon\", this.icon);\n        }\n        const option = {\n          method: \"post\",\n          body: data\n        };\n        fetch(recomGameedit, option)\n          .then(res => res.json())\n          .then(resJson => {\n            if (resJson.state === \"1\") {\n              this.editflag = false;\n              this.$Message.success(resJson.msg);\n              this.getdata();\n            } else {\n              this.$Message.error(resJson.msg);\n            }\n          });\n      } else {\n        this.$Message.error(\"修改失败\");\n      }\n    },\n    addGame() {\n      if (\n        this.bundle.length > 0 &&\n        this.name.length > 0 &&\n        this.version.length > 0 &&\n        this.platform.length > 0 &&\n        this.icon\n      ) {\n        let data = new FormData();\n        data.append(\"bundle\", this.bundle);\n        data.append(\"name\", this.name);\n        data.append(\"version\", this.version);\n        data.append(\"platform\", this.platform);\n        data.append(\"icon\", this.icon);\n        const option = {\n          method: \"post\",\n          body: data\n        };\n        fetch(recomGameadd, option)\n          .then(res => res.json())\n          .then(resJson => {\n            if (resJson.state === \"1\") {\n              this.addflag = false;\n              this.$Message.success(resJson.msg);\n              this.getdata();\n            } else {\n              this.$Message.error(resJson.msg);\n            }\n          });\n      } else {\n        this.$Message.error(\"添加失败\");\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.recommend {\n  width: 100%;\n  height: 100%;\n  padding: 20px;\n}\n\n.addgame {\n  text-align: center;\n  margin-top: 10px;\n}\n.upload_image {\n  position: absolute;\n  top: 0;\n  transform: translate(-50%, 0);\n  height: 100%;\n}\n.addbtn {\n  margin-bottom: 10px;\n}\n</style>\n"],"sourceRoot":"src/views/Manage"}]}